# 表达式
C++语言提供了一套丰富的运算符，并定义了这些运算符作用域内置类型的运算对象时所执行的操作。同时，当运算对象是类类型时，C++语言也允许由用户指定上述运算符的含义。

表达式由一个或多个**运算对象（operand）**组成，对表达式求值将得到一个**结果（result）**。字面值和变量是最简单的**表达式（expression）**，其结果就是字面值和变量的值。把一个**运算符（operator）**和一个或多个运算对象组合起来可以生成较为复杂的表达式。



## 基础

### 基本概念
C++定义了**一元运算符（unary operator）**和**二元运算符（binary operator）**。作用于一个运算对象的运算符是一元运算符；作用于两个运算对象的运算符是二元运算符。除此之外，还有一个作用于三个运算对象的三元运算符。函数调用也是一种特殊的运算符，它对运算对象的数量没有限制。

一些符号既能作为一元运算符也能作为二元运算符，对于这类符号来说，它的两种用法互不相干，完全可以当成是两个不同的符号。

#### 组合运算符和运算对象
对于含有多个运算符的复杂表达式来说，要想理解它的含义首先要理解运算符的**优先级（precedence）**、**结合律（associativity）**以及运算对象的**求值顺序（order of evaluation）**。

#### 运算对象转换
在表达式求值的过程中，运算对象常常由一类类型转换成另外一种类型。小整数类型（如bool、char、short等）通常会被**提升（promoted）**成较大的整数类型，主要是int。

#### 重载运算符
C++语言定义了运算符作用于内置类型和复合类型的运算对象时所执行的操作。当运算符作用于类类型的运算对象时，用户可以自定义其含义。因为这种自定义的过程事实上是为已存在的运算符赋予另外一层含义，所以称之为**重载运算符（overloaded operator）**。

我们使用重载运算符时，其包括运算对象的类型和返回值的类型，都是由该运算符定义的；但是运算对象的个数、运算符的优先级和结合律都是无法改变的。

#### 左值和右值
C++的表达式要不然是右值（rvalue），要不然就是左值（lvalue）。

一个左值表达式的求值结果是一个对象或者一个函数，然而以常量对象为代表的某些左值实际上不能作为赋值语句的左侧对象。此外，虽然某些表达式的求值结果是对象，但它们是右值而非左值。当一个对象被用作右值的时候，用的是对象的值（内容）；当对象被用作左值的时候，用的是对象的身份（在内存中的位置）。

在需要右值的地方可以用左值来代替，但是不能把右值当成左值（也就是位置）来使用。当一个左值被当成右值使用时，实际使用的是它的内容（值）。

使用关键字decltype的时候，左值和右值也有所不同。如果表达式的求值结果是左值，decltype作用于该表达式（不是变量）得到一个引用类型。

### 优先级和结合律
复合表达式（compound expression）是指含有两个或多个运算符的表达式。求复合表达式的值需要首先将运算符和运算对象合理地组合在一起，优先级和结合律决定了运算对象组合的方式。也就是说，它们决定了表达式中每个运算符对应的运算对象来自表达式的哪一部分。表达式中的括号无视上述规则，程序员可以使用括号将表达式的某个局部括起来使其得到优先运算。

一般来说，表达式最终的值依赖于其子表达式的组合方式。高优先级运算符的运算对象要比低优先级运算符的运算对象更为紧密地组合在一起。如果优先级相同，则其组合规则由结合律确定。

#### 括号无视优先级与结合律
括号无视普通的组合规则，表达式中括号括起来的部分被当成一个单元来求值，然后再与其他部分一起按照优先级组合。