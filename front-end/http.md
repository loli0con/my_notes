# HTTP
Web使用一种名为HTTP（HyperText Transfer Protocol，超文文本传输协议）的协议作为规范，完成从客户端到服务端等一些列运作流程。

## URI
URI是Uniform Resource Identifier（统一资源标识符）的缩写：
* Uniform：规定统一的格式可方便处理多种不同类型的资源，而不用根据上下文环境来识别资源指定的访问方式。加入新增的协议方案也更容易。
* Resource：资源的定义是“可标识的任何东西”。除了文档文件、图像或服务等能够区别于其他类型的，全都可作为资源。资源不仅可以是单一的，也可以是多数的集合体。
* Identifier：表示可标识的对象，也称为标识符。

综上所诉，URI就是由某个协议方案标识的资源的定位标识符。协议方案是指访问资源所使用的协议类型名称。

### 🌰
![http+20210718150018](https://raw.githubusercontent.com/loli0con/picgo/master/images/http%2B20210718150018.png%2B2021-07-18-15-00-20)

### 格式
表示指定的URI，要使用涵盖全部必要信息的绝对URI、绝对URL以及相对URL。
![http+20210718150332](https://raw.githubusercontent.com/loli0con/picgo/master/images/http%2B20210718150332.png%2B2021-07-18-15-03-33)

* 登录信息（认证）：指定用户名和密码作为从服务器获取资源时必要的登录信息（身份认证）此项是可选项。
* 服务器地址：使用绝对URI必须指定待访问的服务器地址。地址可以是类似hackr.jp这种DNS可解析的名称，或是192.168.1.1这类似IPv4地址名，还可以是\[0:0:0:0:0:0:0:1]这样用方括号括起来的IPv6地址名。
* 服务器端口号：指定服务器连接的网络端口号。此项也是可选项，若用户省略则自动使用默认端口号。
* 带层次的文件路径：指定服务器上文件路径来定位特指的资源。这与UNIX系统的文件目录结构相似。
* 查询字符串：针对已指定的文件路径内的资源，可以使用查询字符串传入任意参数。此项可选。
* 片段标识符：使用片段标识符通常可标记出已获得资源中的子资源（文档内的某个位置）。该项也为可选项。

## HTTP简介
### HTTP协议用于客户端和服务端之间的通信
请求访问文本或者图像等资源的一端称为客户端，而提供资源响应的一端称为服务端。
### 通过请求和响应的交换达成通信
请求必定由客户端发出，而服务端回复响应
### HTTP协议是不保存状态的协议
HTTP协议自身不具备保存之前发送过的请求或响应的功能。  
为了实现保持状态功能，需要使用Cookie技术。
### 请求URI定位资源
因为URI的特定功能，在互联网上任意位置的资源都可以访问到。
### 告知服务器意图的HTTP方法
* GET：获取资源
* POST：传输实体主体
* PUT：传输文件
* HEAD：获得报文首部
* DELETE：删除文件
* OPTIONS：询问支持的方法
* TRACE：追踪路径
* CONNECT：要求用隧道协议连接代理
### 持久连接节省流量
#### 持久连接
持久连接旨在建立1次TCP连接后进行多次请求和响应的交互，只要任意一端没有明确提出断开连接，则保持TCP连接状态。
#### 管线化
在持久连接的基础上，管线化能够做到同时并行发送多个请求，而不需要一个接着一个地等待响应。
### 使用Cookie的状态管理
Cookie技术通过在请求和响应报文中写入Cookie信息里控制客户端的状态。

Cookie会根据从服务端发送的响应报文内的一个叫做Set-Cookie的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入Cookie值后发送出去。服务端发现客户端发送过来的Cookie后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息。

## HTTP报文
用于HTTP协议交互的信息被称为HTTP报文。请求端（客户端）的HTTP报文叫做请求报文，响应端（服务端）的叫做响应报文。HTTP报文本身是由多行（用CR+LF作换行符）数据结构的字符串文本。

HTTP报文大致可分为报文首部和报文主体两块。两者由最初出现的空行（CR+LF）来划分。通常，并不一定要有报文主体。
![http+20210718153821](https://raw.githubusercontent.com/loli0con/picgo/master/images/http%2B20210718153821.png%2B2021-07-18-15-38-22)

### 请求报文和响应报文的结构
![http+20210718155345](https://raw.githubusercontent.com/loli0con/picgo/master/images/http%2B20210718155345.png%2B2021-07-18-15-53-47)

请求报文和响应报文的首部内容由以下的数据组成：
* 请求行：包含用于请求的方法，请求URI和HTTP版本
* 状态行：包含表明响应结果的状态码，原因短语和HTTP版本
* 首部字段：包含表示请求和响应的各种条件和属性的各类首部，一般有4种首部，分别是：通用首部、请求首部、响应首部、实体首部。
* 其他：可能包含HTTP的RFC里未定义的首部（Cookie等）

### 首部字段
HTTP协议的请求和响应报文中必定包含HTTP首部，首部内容为客户端和服务器分别处理请求和响应提供所需要的信息。

HTTP首部字段传递重要信息，包括报文主题大小、所使用的语言、认证信息等内容。

#### 格式
HTTP首部字段是由首部字段名和字段值构成的，中间用冒号“:”分隔
——`首部字段名: 字段值`。  
另外，字段值对应单个HTTP首部字段，可以有多个值。

#### 分类
HTTP首部字段值根据实体用途分为以下四种类型：
* 通用首部字段：请求报文和响应报文两方都会使用的首部
* 请求首部字段：补充了请求的附加内容、客户端信息、响应内容优先级等信息
* 响应首部字段：补充了响应的附加内容，也会要求客户端附加额外的内容信息

## 参考
* https://www.jb51.net/books/327734.html
* https://www.runoob.com/http/http-tutorial.html
* https://www.cnblogs.com/ranyonsue/p/5984001.html
* https://hit-alibaba.github.io/interview/basic/network/HTTP.html
* https://www.ruanyifeng.com/blog/2016/08/http.html
* https://www.liaoxuefeng.com/wiki/1016959663602400/1017804782304672